<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <link rel="stylesheet" href="css/jquery.mobile-1.4.2.min.css">
        <link rel="stylesheet" href="css/app.css">
        <link rel="stylesheet" href="css/weather.css">
        <link rel="stylesheet" href="css/nav_bar.css">
        <link rel="stylesheet" href="css/main.css">

        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="serial.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script src="js/jquery.js"></script>
        <script type="text/javascript" src='js/jquery.loadTemplate-1.4.4.min.js'></script>
        <script type="text/javascript" src='js/jquery.xml2json.js'></script>
        <script type="text/javascript" src='js/jquery.storageapi.min.js'></script>
        <script type="text/javascript" src='js/jquery.timers-1.2.js'></script>
        <script type="text/javascript" src='js/jquery.effect-slide.js'></script>
        <script type="text/javascript" src='js/app.js'></script>
        <script type="text/javascript" src='js/md5.js'></script>
        <script src="js/jquery.mobile-1.4.2.min.js"></script>  
        <title>智能球车</title>
    </head>
    <body id='body'>
        <div data-role="page" data-control-title="Home" id="home">
            <div class='nav_bar' data-theme="a" data-role="header">
                <div class="ui-grid-b">
                  <div class="ui-block-a left_block">
                    <a href="#home" class='item home'>
                      首页
                    </a>
                    <a href="#home" class='item golf'>
                      球场
                    </a>
                    <a href="debug.html" class='item help' rel='external'>
                      救援
                    </a>
                    <a href="#home" class='item about'>
                      关于
                    </a>
                    <!-- <a href="#home" class='item battery'>
                      电池
                    </a> -->
                    <!-- <a href="#home" class='item after_sale'>
                      售后
                    </a>
                    <a href="#home" class='item repair'>
                      维修
                    </a> -->
                  </div>
                  <div class="ui-block-b mid_block">
                    <div id='clock' class='clock'>
                      <small>中午 11:12</small>
                    </div>
                  </div>
                  <div class="ui-block-c right_block">
                    <a href="" class='battery_power'>
                      40%
                    </a>
                    <div class='weather'>
                      <content>
                        <img src="img/weather/04.png">
                        <city>
                          海口
                        </city>
                        <temp>
                          25~34°
                        </temp>
                        <desc>
                          多云转雷阵雨
                        </desc>
                      </content>
                    </div>
                  </div>
              </div><!-- /grid-b -->
            </div>
            <div role="main" class="ui-content" id='adv'>
              <img src="img/ad/home/0.png" id='adv_img_1'>
              <img src="img/ad/home/1.png" class='hidden' id='adv_img_2'>
              <img src="img/ad/home/2.png" class='hidden' id='adv_img_3'>
              <img src="img/ad/home/3.png" class='hidden' id='adv_img_4'>
              <img src="img/ad/home/4.png" class='hidden' id='adv_img_5'>
            </div>
            <script type="text/javascript"> 
              $current_home_adv_frame_index = 1;
              $home_max_adv_frames_count = 5;
              $home_adv_paused = false;
              $home_adv_skip_this_frame = false;

              $(document).everyTime('15s','home_adv_play',function() {
                log('开始播放adv....')
                if(!$home_adv_paused) {
                  if($home_adv_skip_this_frame) {
                    $home_adv_skip_this_frame = false;
                  } else {
                    $next_adv_frame();                                        
                  }                  
                }
              })

              $next_adv_frame = function() {
                var old_index = $current_home_adv_frame_index;                
                if($current_home_adv_frame_index == $home_max_adv_frames_count) {
                  $current_home_adv_frame_index = 1;
                } else {
                  $current_home_adv_frame_index += 1;
                }
                $show_adv_frame(old_index);
              }

              $show_adv_frame = function(old_index) {
                log('show adv frame ' + $current_home_adv_frame_index);
                $('#adv_img_' + old_index).fadeOut(1000,function() {
                  $('#adv_img_' + $current_home_adv_frame_index).fadeIn(2000);  
                });
              }

              $(document).everyTime('30s','clock',$show_clock);

              $('#adv').on('vmousedown',function() {
                log('vmousedown');
                $home_adv_paused = true;
              })

              $('#adv').on('vmouseup',function() {
                log('vmouseup');
                $home_adv_paused = false;
              })

              $('#adv').on('swipeleft',function() {
                $home_adv_skip_this_frame = true;
                var old_index = $current_home_adv_frame_index;
                if($current_home_adv_frame_index == $home_max_adv_frames_count) {
                  $current_home_adv_frame_index = 1;
                } else {
                  $current_home_adv_frame_index += 1;
                }
                log('show_adv_frame :' + old_index + ' => ' + $current_home_adv_frame_index)
                $('#adv_img_' + old_index).hide("slide", { direction: "left" },400,function() {
                  $('#adv_img_' + $current_home_adv_frame_index).show("slide", { direction: "right" },400);  
                });
              })

              $('#adv').on('swiperight',function() {
                $home_adv_skip_this_frame = true;
                var old_index = $current_home_adv_frame_index;
                if($current_home_adv_frame_index == 1) {
                  $current_home_adv_frame_index = $home_max_adv_frames_count;
                } else {
                  $current_home_adv_frame_index -= 1;
                }
                log('show_adv_frame :' + old_index + ' => ' + $current_home_adv_frame_index)
                $('#adv_img_' + old_index).hide("slide", { direction: "right" },400,function() {
                  $('#adv_img_' + $current_home_adv_frame_index).show("slide", { direction: "left" },400);  
                });
              })
            </script>
        </div>
        <script type="text/javascript">          
            $(document).on('pageinit','#home',function(){
              $('#body').addClass('overflow_hidden');
            });
            $(document).on('pageshow','#home',function(){
              log('#home show');
              $('#body').addClass('overflow_hidden');
              $home_adv_paused = false;
              $show_clock();
            });
            $(document).on('pagehide','#home',function(){
              log('#home hide');
              $home_adv_paused = true;
              $('#body').removeClass('overflow_hidden');
            });

            // $('#home').on('')
        </script>
        <div data-role="page" data-control-title="Home" id="batterys_index">
            <div data-theme="a" data-role="header">
                <h1 class="ui-title">
                    电池健康状态
                </h1>
            </div>
            <div id='batteries' role="main" class="ui-content">
            </div>
            <script  type="text/html" id="battery_in_index_template">
                <div class="battery ui-grid-a">
                    <div class="ui-block-a">
                        <div data-controltype="image">
                            <img src="icon.png">
                        </div>
                    </div>
                    <div class="ui-block-b">
                        <div class="ui-field-contain name">
                            <span data-content="name"></span>
                        </div>
                        <div class="ui-field-contain">
                            电量：<span data-content="eq"></span>%
                        </div>
                        <div class="ui-field-contain">
                            健康：<span data-content="soh"></span>%
                        </div>
                        <div class="ui-field-contain">
                            循环：<b data-content="cc"></b>次
                        </div>
                    </div>
                </div>
            </script>
            <script type="text/javascript">
                $bs = [{
                    name: '1号',
                    eq: 80,
                    soh: 98,
                    cc: 12
                },{
                    name: '2号',
                    eq: 70,
                    soh: 88,
                    cc: 13
                },{
                    name: '3号',
                    eq: 90,
                    soh: 97,
                    cc: 12
                },{
                    name: '4号',
                    eq: 95,
                    soh: 95,
                    cc: 13
                },{
                    name: '5号',
                    eq: 98,
                    soh: 90,
                    cc: 15
                },{
                    name: '6号',
                    eq: 100,
                    soh: 99,
                    cc: 3
                },{
                    name: '7号',
                    eq: 60,
                    soh: 75,
                    cc: 50
                },{
                    name: '8号',
                    eq: 99,
                    soh: 99,
                    cc: 3
                },{
                    name: '9号',
                    eq: 75,
                    soh: 88,
                    cc: 5
                },{
                    name: '10号',
                    eq: 55,
                    soh: 67,
                    cc: 200
                }];
                $("#batteries").loadTemplate($("#battery_in_index_template"), $bs);
                $(function() {
                    $('#batteries .battery').tap(function() {
                      $.mobile.changePage( "#show", { transition: "slideup"});
                    })
                })                
            </script>
        </div>            
        <div data-role="page" data-control-title="Home" id="show">
            <div data-theme="a" data-role="header">
                <h1 class="ui-title">
                    1号电池健康状态
                </h1>
                <a href="#index" data-iconpos="left" class="ui-btn ui-icon-bullets ui-btn-icon-notext ui-corner-all ui-btn-right">
                    设置
                </a>
            </div>
            <div role="main" class="ui-content">
                <div style="" data-controltype="image">
                    <img style="width: 128px; height: 128px" src="icon.png">
                </div>
                <div id='status' class="ui-field-contain">
                    <fieldset data-role="controlgroup" data-type="horizontal">
                        <legend>当前状态</legend>
                        <input name="status" id="status_1" value="空闲" checked="checked" type="radio">
                        <label for="status_1" class='status_label1'>空闲</label>
                        <input name="status" id="status_2" value="繁忙" type="radio">
                        <label for="status_2" class='status_label2'>繁忙</label>
                    </fieldset>
                </div>
                <ul data-role="listview" data-div   ider-theme="a" data-inset="true">
                    <li data-role="list-divider" role="heading">                    
                        联系电话
                    </li>
                    <li>
                        <a id='link_mobile' href="setting.html#edit"  rel='external' data-transition="slide" class='ui-icon-edit'> 
                            读取中...
                        </a>
                    </li>
                    <li data-role="list-divider" role="heading">
                        服务范围
                    </li>
                    <li>
                        <a id='clserver' href="setting.html#edit"  rel='external' class='ui-icon-edit'>全国</a>
                    </li>
                </ul>
                <ul data-role="listview" data-div   ider-theme="a" data-inset="true">
                    <li data-role="list-divider" role="heading">
                        车身长度
                    </li>
                    <li>
                        <a id='clLength' href="setting.html#edit"  rel='external' data-transition="slide" class='ui-icon-edit'> 
                            读取中...
                        </a> 
                    </li>
                </ul>   
                <a class='ui-btn ui-corner-all ui-btn-icon-left ui-icon-grid' href="setting.html" rel='external'>
                    更多设置......
                </a>      
                <a href="#login_out_confirm" data-rel="popup" data-position-to="window" data-transition="pop" class="ui-btn ui-corner-all ui-btn-icon-left ui-icon-power">我要退出登录</a>
                <div data-role="popup" id="login_out_confirm"  data-dismissible="false" style="max-width:400px;">
                    <div data-role="header" data-theme="a">
                    <h1>即将离线?</h1>
                    </div>
                    <div role="main" class="ui-content">
                        <h3 class="ui-title">您确认要让自己下线，导致货主们无法找到您吗?</h3>
                    <p>当然，休息下也是可以的，只要重新登录就恢复了.</p>
                        <a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-icon-left ui-icon-check" data-rel="back">不了，我要继续在线</a>
                        <a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-icon-left ui-icon-delete" data-rel="back" data-transition="flow" id='login_out'>是的，我要下线</a>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>    